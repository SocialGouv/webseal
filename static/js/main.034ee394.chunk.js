(this["webpackJsonp@socialgouv/webseal"]=this["webpackJsonp@socialgouv/webseal"]||[]).push([[0],{193:function(e,t){},195:function(e,t){},205:function(e,t){},207:function(e,t){},232:function(e,t){},233:function(e,t){},238:function(e,t){},240:function(e,t){},247:function(e,t){},266:function(e,t){},286:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),r=a(160),s=a.n(r),i=a(161),o=a.n(i),l=a(27),j=a(41),u=a(290),b=a(292),m=a(289),p=a(163),d=a(294),O=a(162),x=a(291),h=(a(176),a(165)),f=a(293),y=a(295),g=a(166),v=a(49),S=a(3);const C=n.a.forwardRef(((e,t)=>{let a=e.name,c=e.value,n=Object(h.a)(e,["name","value"]);return Object(S.jsx)(f.a.Check,Object(j.a)({inline:!0,ref:t,name:a,id:"".concat(a,"-").concat(c),label:c,type:"radio",value:c},n))})),k=({onSubmit:e})=>{const t=Object(g.a)({mode:"all",defaultValues:{pemKey:"",value:"",namespace:"",name:"",scope:"cluster"}}),a=t.register,c=t.handleSubmit,n=t.getValues,r=t.formState,s=t.setValue,i=t.trigger,o=n("scope"),l=n("pemKey"),j=r.isDirty?Object(v.a)(l):Object(v.a)("");return Object(S.jsxs)(f.a,{onSubmit:c((t=>{e(t)})),children:[Object(S.jsx)(m.a,{children:Object(S.jsxs)(p.a,{children:[Object(S.jsxs)(f.a.Label,{children:["Server public certificate (PEM key) :"," ",j?"":"\u274c Provided key is invalid"]}),Object(S.jsx)(f.a.Group,{children:Object(S.jsx)(f.a.Control,{as:"textarea",name:"pemKey",style:{marginTop:10,fontSize:"0.8rem",fontFamily:"Courier"},rows:8,onChange:e=>{s("pemKey",e.target.value),i()},ref:a({required:!0}),placeholder:"-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----",defaultValue:""})})]})}),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(p.a,{xs:12,sm:3,children:Object(S.jsx)(f.a.Label,{children:"Scope :"})}),Object(S.jsxs)(p.a,{sm:9,children:[Object(S.jsx)(C,{name:"scope",value:"cluster",ref:a,onChange:e=>{s("scope",e.target.value),i()}}),Object(S.jsx)(C,{name:"scope",value:"namespace",ref:a,onChange:e=>{s("scope",e.target.value),i()}}),Object(S.jsx)(C,{name:"scope",value:"strict",ref:a,onChange:e=>{s("scope",e.target.value),i()}})]})]}),("namespace"===o||"strict"===o)&&Object(S.jsxs)(f.a.Group,{as:m.a,children:[Object(S.jsx)(f.a.Label,{column:!0,children:"Namespace :"}),Object(S.jsx)(p.a,{sm:"9",children:Object(S.jsx)(f.a.Control,{name:"namespace",ref:a({required:!0}),required:!0,type:"text",placeholder:"Namespace"})})]}),"strict"===o&&Object(S.jsxs)(f.a.Group,{as:m.a,children:[Object(S.jsx)(f.a.Label,{column:!0,children:"Secret name :"}),Object(S.jsx)(p.a,{sm:"9",children:Object(S.jsx)(f.a.Control,{name:"name",ref:a({required:!0}),type:"text",placeholder:"Secret name"})})]}),Object(S.jsx)(f.a.Group,{children:Object(S.jsx)(f.a.Control,{as:"textarea",name:"value",onChange:e=>{s("value",e.target.value),i()},style:{marginTop:10},rows:4,ref:a({required:!0}),placeholder:"Value to encrypt"})}),Object(S.jsx)(y.a,{disabled:!r.isDirty||!r.isValid,block:!0,variant:"primary",type:"submit",children:"Encrypt"})]})};var T=a(164),w=a.n(T);const E=()=>Object(S.jsxs)(u.a,{style:{padding:"2rem 1rem"},children:[Object(S.jsx)("h1",{children:"WebSeal"}),Object(S.jsx)("p",{children:"Client-side sealed-secrets generation"})]}),V=e=>Object(S.jsx)("textarea",Object(j.a)(Object(j.a)({},e),{},{style:Object(j.a)({fontSize:"0.8rem",fontFamily:"Courier",border:"1px solid #ccc",width:"100%",padding:5,height:400},e.style||{})})),K=({text:e})=>{const t=Object(c.useState)(!1),a=Object(l.a)(t,2),n=a[0],r=a[1];return Object(S.jsx)(O.CopyToClipboard,{text:e,onCopy:()=>{r(!0),setTimeout((()=>r(!1)),2e3)},children:Object(S.jsx)(x.a,{style:{marginLeft:10,cursor:"pointer",transition:"all 0.2s ease-in"},color:n?"green":"black",title:"Copy",size:16})})},F=()=>{const e=Object(c.useState)(null),t=Object(l.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)(null),s=Object(l.a)(r,2),i=s[0],o=s[1];return Object(S.jsxs)(b.a,{children:[Object(S.jsx)(E,{}),Object(S.jsx)(m.a,{children:Object(S.jsxs)(p.a,{xs:12,children:[Object(S.jsx)(d.a,{children:Object(S.jsx)(d.a.Body,{children:Object(S.jsx)(k,{onSubmit:e=>{console.log("onSubmit2",e),n(""),o(""),Object(v.b)(e).then((t=>{n(t);const a=(({namespace:e="some-namespace",name:t="some-secret-name",scope:a="strict",encryptedData:c})=>{const n={};"cluster"===a?n["sealedsecrets.bitnami.com/cluster-wide"]="true":"namespace"===a&&(n["sealedsecrets.bitnami.com/namespace-wide"]="true");const r={apiVersion:"bitnami.com/v1alpha1",kind:"SealedSecret",metadata:{annotations:n,name:t,namespace:e},spec:{encryptedData:c},template:{metadata:{annotations:n,name:t},type:"Opaque"}};return w.a.stringify(r)})({namespace:e.namespace,name:e.name,scope:e.scope,encryptedData:{VALUE:t}});o(a)})).catch(console.log)}})})}),a&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(d.a,{style:{marginTop:10},children:Object(S.jsxs)(d.a.Body,{children:[Object(S.jsxs)(d.a.Title,{children:["Encrypted",Object(S.jsx)(K,{text:a})]}),Object(S.jsx)(V,{defaultValue:a,style:{height:200}})]})}),Object(S.jsx)(d.a,{style:{marginTop:10},children:Object(S.jsxs)(d.a.Body,{children:[Object(S.jsxs)(d.a.Title,{children:["SealedSecret ",Object(S.jsx)(K,{text:i})]}),Object(S.jsx)(V,{defaultValue:i})]})})]})]})})]})};function G(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsx)(F,{})})}const q=document.getElementById("root");s.a.render(Object(S.jsxs)(c.StrictMode,{children:[Object(S.jsx)(G,{}),Object(S.jsx)(o.a,{color:"green",target:"_blank",href:"https://github.com/SocialGouv/webseal",children:"Fork me on GitHub"})]}),q)},49:function(e,t,a){"use strict";(function(e){a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return j}));var c=a(14),n=a.n(c),r=a(21),s=a(59),i=a(90);const o=({scope:e,namespace:t,name:a})=>"cluster"===e?"":"namespace"===e?t:"".concat(t,"/").concat(a),l=function(){var t=Object(r.a)(n.a.mark((function t({pemKey:a,scope:c,namespace:r,name:l,value:j}){var u,b,m,p,d;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=s.pki.certificateFromPem(a),b=s.pki.publicKeyToPem(u.publicKey),t.next=4,Object(i.pemPublicKeyToCryptoKey)(b);case 4:return m=t.sent,p=e.from(o({scope:c,namespace:r,name:l})),t.next=8,Object(i.HybridEncrypt)(m,j,p);case 8:return d=t.sent,t.abrupt("return",e.from(d).toString("base64"));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=e=>{let t=!1;try{s.pki.certificateFromPem(e),t=!0}catch(a){console.log("e",a)}return t}}).call(this,a(12).Buffer)},64:function(e,t){}},[[286,1,2]]]);
//# sourceMappingURL=main.034ee394.chunk.js.map