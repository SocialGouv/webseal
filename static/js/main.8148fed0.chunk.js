(this["webpackJsonp@socialgouv/webseal"]=this["webpackJsonp@socialgouv/webseal"]||[]).push([[0],{190:function(e,t){},192:function(e,t){},202:function(e,t){},204:function(e,t){},229:function(e,t){},230:function(e,t){},235:function(e,t){},237:function(e,t){},244:function(e,t){},263:function(e,t){},285:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(157),r=a.n(s),o=a(158),i=a.n(o),l=a(10),j=a.n(l),b=a(17),u=a(16),d=a(11),p=a(288),m=a(290),O=a(287),h=a(162),x=a(292),y=a(159),f=a(289),g=a(160),v=a(161),S=(a(279),a(55));const w=e=>{let t=!1;try{S.pki.certificateFromPem(e),t=!0}catch(a){console.log("e",a)}return t};var C=a(163),k=a(291),T=a(164),E=a(86);var K=a(1);const F=n.a.forwardRef(((e,t)=>{let a=e.name,c=e.value,n=Object(C.a)(e,["name","value"]);return Object(K.jsx)(k.a.Check,Object(d.a)({inline:!0,ref:t,name:a,id:"".concat(a,"-").concat(c),label:c,type:"radio",value:c},n))})),L=(R=e=>["namespace","scope","cluster","name","pemKey"].includes(e),e=>Object.keys(e).filter(R).reduce(((t,a)=>Object(d.a)(Object(d.a)({},t),{},{[a]:e[a]})),{}));var R;const B=({onSubmit:e,initialFormData:t})=>{const a=(()=>{const e=Object(E.parse)(window.location.hash),t=Object(c.useState)(e),a=Object(u.a)(t,2),n=a[0],s=a[1];return[n,Object(c.useCallback)((e=>{window.history.replaceState({},window.title,document.location.href.split("#")[0]+"#"+Object(E.stringify)(e)),s(e)}),[s])]})(),s=Object(u.a)(a,2),r=s[0],o=s[1],i=L(r),l=Object(d.a)(Object(d.a)({},t),i),j=Object(T.a)({mode:"onChange",defaultValues:l}),b=j.register,p=j.handleSubmit,m=j.watch,y=j.setValue,f=j.trigger,g=j.getValues,v=(j.formState,t=>{o(L(t)),e(t)}),S=m("value"),C=m("pemKey"),R=w(C);return n.a.useEffect((()=>{const e=m((({name:e,type:t})=>{const a=g();v(a)}));return()=>e.unsubscribe&&e.unsubscribe()}),[m]),Object(K.jsxs)(k.a,{onSubmit:p(v),children:[Object(K.jsx)(x.a,{children:Object(K.jsxs)(x.a.Body,{children:[Object(K.jsx)(O.a,{children:Object(K.jsxs)(h.a,{children:[Object(K.jsxs)(k.a.Label,{children:["Server public certificate (PEM key) :"," ",R?"":"\u274c Provided key is invalid"]}),Object(K.jsx)(k.a.Group,{children:Object(K.jsx)(k.a.Control,Object(d.a)(Object(d.a)({as:"textarea",name:"pemKey",style:{marginTop:10,fontSize:"0.8rem",fontFamily:"Courier"},rows:8},b("pemKey",{required:!0})),{},{placeholder:"-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----"}))})]})}),Object(K.jsxs)(O.a,{children:[Object(K.jsx)(h.a,{xs:2,children:Object(K.jsx)(k.a.Label,{style:{marginRight:10},children:"Scope :"})}),Object(K.jsxs)(h.a,{xs:10,children:[Object(K.jsx)(F,Object(d.a)(Object(d.a)({name:"scope",value:"cluster"},b("scope")),{},{onChange:e=>{y("scope",e.target.value),f()}})),Object(K.jsx)(F,Object(d.a)(Object(d.a)({name:"scope",value:"namespace"},b("scope")),{},{onChange:e=>{y("scope",e.target.value),f()}})),Object(K.jsx)(F,Object(d.a)(Object(d.a)({name:"scope",value:"strict"},b("scope")),{},{onChange:e=>{y("scope",e.target.value),f()}}))]})]}),Object(K.jsxs)(k.a.Group,{as:O.a,children:[Object(K.jsx)(k.a.Label,{column:!0,children:"Namespace :"}),Object(K.jsx)(h.a,{xs:"10",children:Object(K.jsx)(k.a.Control,Object(d.a)(Object(d.a)({name:"namespace"},b("namespace",{required:!0})),{},{required:!0,type:"text",placeholder:"Namespace"}))})]}),Object(K.jsxs)(k.a.Group,{as:O.a,children:[Object(K.jsx)(k.a.Label,{column:!0,children:"Secret name :"}),Object(K.jsx)(h.a,{xs:"10",children:Object(K.jsx)(k.a.Control,Object(d.a)(Object(d.a)({name:"name"},b("name",{required:!0})),{},{type:"text",placeholder:"Secret name"}))})]})]})}),Object(K.jsx)(x.a,{style:{marginTop:10},children:Object(K.jsx)(x.a.Body,{children:Object(K.jsxs)(k.a.Group,{children:[Object(K.jsx)("h4",{children:"Values to encrypt :"}),Object(K.jsx)(k.a.Control,Object(d.a)(Object(d.a)({as:"textarea",name:"value",id:"value",style:{marginTop:10},rows:4},b("value",{required:!0,value:S})),{},{placeholder:"MY_TOKEN=SomeSuperSecretToken\nMY_PASSWORD=SomeSuperSecretPassword"}))]})})})]})},G=[{title:"\u2693\ufe0f Use the URL luke",description:"We provide a safe and friendly URL to create new secrets with the same parameters"},{title:"\ud83d\udd10 Use a strict scope",description:"Using a strict scope is recommended to increase your sealed-secret robustness"},{title:"\ud83d\udce6 A sealed-secret produce a readable Kubernetes Secret",description:"Once unencrypted in the destination namespace, your sealed-secret creates a standard kubernetes Secret."}],N=()=>G.map((e=>Object(K.jsx)(x.a,{style:{marginTop:10},children:Object(K.jsxs)(x.a.Body,{children:[Object(K.jsx)("h5",{children:e.title}),e.description]})}))),A=()=>Object(K.jsxs)(p.a,{style:{marginTop:"1rem",marginBottom:"1rem",padding:"1rem 1rem"},children:[Object(K.jsx)("h1",{children:"WebSeal"}),Object(K.jsx)("p",{children:"Client-side sealed-secrets generation"})]}),I=e=>Object(K.jsx)("textarea",Object(d.a)(Object(d.a)({},e),{},{style:Object(d.a)({fontSize:"0.8rem",fontFamily:"Courier",border:"1px solid #ccc",width:"100%",padding:5,height:400},e.style||{})})),U=({text:e})=>{const t=Object(c.useState)(!1),a=Object(u.a)(t,2),n=a[0],s=a[1];return Object(K.jsx)(y.CopyToClipboard,{text:e,onCopy:()=>{s(!0),setTimeout((()=>s(!1)),2e3)},children:Object(K.jsx)(f.a,{style:{marginLeft:10,cursor:"pointer",transition:"all 0.2s ease-in"},color:n?"green":"black",title:"Copy",size:16})})},V=()=>{const e=Object(c.useState)({cluster:"dev",namespace:"",name:"",pemKey:""}),t=Object(u.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)(null),r=Object(u.a)(s,2),o=r[0],i=r[1],l=Object(c.useState)(null),d=Object(u.a)(l,2),p=d[0],y=d[1],f=function(){var e=Object(b.a)(j.a.mark((function e(t){var c,s,r,o,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=w(t.pemKey),n(t),i(""),y(""),c){e.next=6;break}return e.abrupt("return");case 6:if(!t.value||t.value===a.value){e.next=21;break}return s=t.pemKey,r={},t.value.match(/^([\w_\d]+)=(.+)$/im)?t.value.split("\n").forEach((e=>{const t=e.match(/^([\w_\d]+)=(.*)$/i);t&&(r[t[1]]=t[2])})):r.VALUE=t.value,e.prev=10,e.next=13,Object(v.getSealedSecret)({pemKey:s,namespace:t.namespace||"some-namespace",name:t.name||"some-secret-name",scope:t.scope,values:r});case 13:o=e.sent,e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(10),console.log("cannot create sealed secret",e.t0.message),e.abrupt("return");case 20:"strict"!==t.scope||t.namespace&&t.name?"namespace"!==t.scope||t.namespace?t.value?(1===(l=Object.keys(r)).length?i(o.spec.encryptedData[l[0]]):i("Not available for multiple values, use the below secret"),y(g.a.dump(o,{noRefs:!0,lineWidth:-1}))):(console.log("value is mandatory"),y(""),i("")):(console.log("namespace is mandatory"),y(""),i("")):(console.log("namespace and name are mandatory"),y(""),i(""));case 21:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(K.jsxs)(m.a,{children:[Object(K.jsx)(A,{}),Object(K.jsx)(O.a,{children:Object(K.jsxs)(h.a,{xs:12,children:[Object(K.jsx)(B,{onSubmit:f,initialFormData:a}),o&&Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(x.a,{style:{marginTop:10},children:Object(K.jsxs)(x.a.Body,{children:[Object(K.jsxs)(x.a.Title,{children:["SealedSecret ",Object(K.jsx)(U,{text:p})]}),Object(K.jsx)(I,{defaultValue:p})]})}),Object(K.jsx)(N,{})]})]})})]})};function q(){return Object(K.jsx)("div",{className:"App",children:Object(K.jsx)(V,{})})}const D=document.getElementById("root");r.a.render(Object(K.jsxs)(c.StrictMode,{children:[Object(K.jsx)(q,{}),Object(K.jsx)(i.a,{color:"green",target:"_blank",href:"https://github.com/SocialGouv/webseal",children:"Fork me on GitHub"})]}),D)},60:function(e,t){}},[[285,1,2]]]);
//# sourceMappingURL=main.8148fed0.chunk.js.map